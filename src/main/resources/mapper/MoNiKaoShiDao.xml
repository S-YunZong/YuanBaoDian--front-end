<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper SYSTEM "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.yuanbaodianfrontend.dao.MoNiKaoShiDao">
    <!--//查看题目类型
    List<YbdQuestionType> selYbdQuestionType(); -->
    <select id="selYbdQuestionType" resultType="YbdQuestionType">
        select * from ybd_question_type
    </select>
    <!--//题库
    List<YbdQuestionBack> listYbdQuestionBack(int questionTypeId);-->
    <select id="listYbdQuestionBack" resultType="YbdQuestionBack" resultMap="OptionMap">
      select ybd_question_back.* ,ybd_user.user_name
      from ybd_question_back,ybd_user
      where question_type_id=#{questionTypeId}
      and ybd_question_back.create_user=ybd_user.id
    </select>
    <resultMap id="OptionMap" type="YbdQuestionBack">
        <id property="id" column="id"></id>
        <collection property="optionList" column="id" select="seldaan" ofType="YbdQuestionBackOption">
        </collection>
    </resultMap>
    <select id="seldaan" resultType="YbdQuestionBackOption">
      select * from ybd_question_back_option where question_back_id=#{id}
    </select>
    <!--id
    int[] listYbdQuestionBackid(int questionTypeId);-->
    <select id="listYbdQuestionBackid" resultType="int">
        select ybd_question_back.id
      from ybd_question_back
      where question_type_id=#{questionTypeId}
    </select>
    <!--//查询章节
    List<YbdChapter> listYbdChapter();-->
    <select id="listYbdChapter" resultType="YbdChapter">
      SELECT * FROM ybd_chapter
    </select>
    <!--//查询关卡
    List<YbdGameLevel> listYbdGameLevel(int id);-->
    <select id="listYbdGameLevel" resultType="YbdGameLevel">
        SELECT * from ybd_game_level where chapter_id=#{id}
    </select>
    <!--/提交疑问
    boolean insYbdPutQuestionsTo(YbdPutQuestionsTo QuestionsTo);-->
    <insert id="insYbdPutQuestionsTo" parameterType="YbdPutQuestionsTo">
        insert into ybd_put_questions_to
        values (null,#{QuestionsTo.objectUserId},#{QuestionsTo.startUserId},
        #{QuestionsTo.questionBackId},#{QuestionsTo.description});
    </insert>
    <!--//闯关查询
    List<YbdQuestionBack> chuangguanYbdQuestionBack(@Param("questionTypeId") int questionTypeId,@Param("gameLevelId") int gameLevelId);
-->
    <select id="chuangguanYbdQuestionBack" resultType="YbdQuestionBack" resultMap="chuangguanMap">
      select ybd_question_back.* ,ybd_user.user_name
      from ybd_question_back,ybd_user
      where question_type_id=#{questionTypeId}
      and ybd_question_back.create_user=ybd_user.id
      and game_level_id=#{gameLevelId}
    </select>
    <resultMap id="chuangguanMap" type="YbdQuestionBack">
        <id property="id" column="id"></id>
        <collection property="optionList" column="id" select="selchuangguan" ofType="YbdQuestionBackOption">
        </collection>
    </resultMap>
    <select id="selchuangguan" resultType="YbdQuestionBackOption">
      select * from ybd_question_back_option where question_back_id=#{id}
    </select>
    <!--id
    int[] chuangguanYbdQuestionBackid(@Param("questionTypeId") int questionTypeId,@Param("gameLevelId") int gameLevelId);-->
    <select id="chuangguanYbdQuestionBackid" resultType="int">
        select ybd_question_back.id
      from ybd_question_back
      where question_type_id=#{questionTypeId}
      and game_level_id=#{gameLevelId}
    </select>
    <!--//添加错题
    boolean insYbdWrongTopicRecord(@Param("ybdWrongTopicRecord") YbdWrongTopicRecord ybdWrongTopicRecord);-->
    <insert id="insYbdWrongTopicRecord" parameterType="YbdWrongTopicRecord">
        insert into ybd_wrong_topic_record (question_back_id,user_id,create_time,error_option)
        values (#{ybdWrongTopicRecord.questionBackId},#{ybdWrongTopicRecord.userId},now(),#{ybdWrongTopicRecord.errorOption});
    </insert>
</mapper>


